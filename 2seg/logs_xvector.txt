============================================================
ENTRENAMIENTO X-VECTOR SMAW (Multi-Task)
============================================================
Duración: 2s
Overlap: 0.5
K-folds: 10
Seed: 42
Device: cuda
============================================================

Verificando CSVs...
CSVs no encontrados. Generando con generar_splits.py...
  Duración: 2s, Overlap: 0.5, Seed: 42
  CSVs generados exitosamente

Cargando features desde CSVs...
Cargando CSVs...
  Train: 15262 segmentos
  Test: 3686 segmentos
  Blind: 2365 segmentos

Extrayendo MFCC de train...
    Procesados 100/15262 segmentos...
    Procesados 200/15262 segmentos...
    Procesados 300/15262 segmentos...
    Procesados 400/15262 segmentos...
    Procesados 500/15262 segmentos...
    Procesados 600/15262 segmentos...
    Procesados 700/15262 segmentos...
    Procesados 800/15262 segmentos...
    Procesados 900/15262 segmentos...
    Procesados 1000/15262 segmentos...
    Procesados 1100/15262 segmentos...
    Procesados 1200/15262 segmentos...
    Procesados 1300/15262 segmentos...
    Procesados 1400/15262 segmentos...
    Procesados 1500/15262 segmentos...
    Procesados 1600/15262 segmentos...
    Procesados 1700/15262 segmentos...
    Procesados 1800/15262 segmentos...
    Procesados 1900/15262 segmentos...
    Procesados 2000/15262 segmentos...
    Procesados 2100/15262 segmentos...
    Procesados 2200/15262 segmentos...
    Procesados 2300/15262 segmentos...
    Procesados 2400/15262 segmentos...
    Procesados 2500/15262 segmentos...
    Procesados 2600/15262 segmentos...
    Procesados 2700/15262 segmentos...
    Procesados 2800/15262 segmentos...
    Procesados 2900/15262 segmentos...
    Procesados 3000/15262 segmentos...
    Procesados 3100/15262 segmentos...
    Procesados 3200/15262 segmentos...
    Procesados 3300/15262 segmentos...
    Procesados 3400/15262 segmentos...
    Procesados 3500/15262 segmentos...
    Procesados 3600/15262 segmentos...
    Procesados 3700/15262 segmentos...
    Procesados 3800/15262 segmentos...
    Procesados 3900/15262 segmentos...
    Procesados 4000/15262 segmentos...
    Procesados 4100/15262 segmentos...
    Procesados 4200/15262 segmentos...
    Procesados 4300/15262 segmentos...
    Procesados 4400/15262 segmentos...
    Procesados 4500/15262 segmentos...
    Procesados 4600/15262 segmentos...
    Procesados 4700/15262 segmentos...
    Procesados 4800/15262 segmentos...
    Procesados 4900/15262 segmentos...
    Procesados 5000/15262 segmentos...
    Procesados 5100/15262 segmentos...
    Procesados 5200/15262 segmentos...
    Procesados 5300/15262 segmentos...
    Procesados 5400/15262 segmentos...
    Procesados 5500/15262 segmentos...
    Procesados 5600/15262 segmentos...
    Procesados 5700/15262 segmentos...
    Procesados 5800/15262 segmentos...
    Procesados 5900/15262 segmentos...
    Procesados 6000/15262 segmentos...
    Procesados 6100/15262 segmentos...
    Procesados 6200/15262 segmentos...
    Procesados 6300/15262 segmentos...
    Procesados 6400/15262 segmentos...
    Procesados 6500/15262 segmentos...
    Procesados 6600/15262 segmentos...
    Procesados 6700/15262 segmentos...
    Procesados 6800/15262 segmentos...
    Procesados 6900/15262 segmentos...
    Procesados 7000/15262 segmentos...
    Procesados 7100/15262 segmentos...
    Procesados 7200/15262 segmentos...
    Procesados 7300/15262 segmentos...
    Procesados 7400/15262 segmentos...
    Procesados 7500/15262 segmentos...
    Procesados 7600/15262 segmentos...
    Procesados 7700/15262 segmentos...
    Procesados 7800/15262 segmentos...
    Procesados 7900/15262 segmentos...
    Procesados 8000/15262 segmentos...
    Procesados 8100/15262 segmentos...
    Procesados 8200/15262 segmentos...
    Procesados 8300/15262 segmentos...
    Procesados 8400/15262 segmentos...
    Procesados 8500/15262 segmentos...
    Procesados 8600/15262 segmentos...
    Procesados 8700/15262 segmentos...
    Procesados 8800/15262 segmentos...
    Procesados 8900/15262 segmentos...
    Procesados 9000/15262 segmentos...
    Procesados 9100/15262 segmentos...
    Procesados 9200/15262 segmentos...
    Procesados 9300/15262 segmentos...
    Procesados 9400/15262 segmentos...
    Procesados 9500/15262 segmentos...
    Procesados 9600/15262 segmentos...
    Procesados 9700/15262 segmentos...
    Procesados 9800/15262 segmentos...
    Procesados 9900/15262 segmentos...
    Procesados 10000/15262 segmentos...
    Procesados 10100/15262 segmentos...
    Procesados 10200/15262 segmentos...
    Procesados 10300/15262 segmentos...
    Procesados 10400/15262 segmentos...
    Procesados 10500/15262 segmentos...
    Procesados 10600/15262 segmentos...
    Procesados 10700/15262 segmentos...
    Procesados 10800/15262 segmentos...
    Procesados 10900/15262 segmentos...
    Procesados 11000/15262 segmentos...
    Procesados 11100/15262 segmentos...
    Procesados 11200/15262 segmentos...
    Procesados 11300/15262 segmentos...
    Procesados 11400/15262 segmentos...
    Procesados 11500/15262 segmentos...
    Procesados 11600/15262 segmentos...
    Procesados 11700/15262 segmentos...
    Procesados 11800/15262 segmentos...
    Procesados 11900/15262 segmentos...
    Procesados 12000/15262 segmentos...
    Procesados 12100/15262 segmentos...
    Procesados 12200/15262 segmentos...
    Procesados 12300/15262 segmentos...
    Procesados 12400/15262 segmentos...
    Procesados 12500/15262 segmentos...
    Procesados 12600/15262 segmentos...
    Procesados 12700/15262 segmentos...
    Procesados 12800/15262 segmentos...
    Procesados 12900/15262 segmentos...
    Procesados 13000/15262 segmentos...
    Procesados 13100/15262 segmentos...
    Procesados 13200/15262 segmentos...
    Procesados 13300/15262 segmentos...
    Procesados 13400/15262 segmentos...
    Procesados 13500/15262 segmentos...
    Procesados 13600/15262 segmentos...
    Procesados 13700/15262 segmentos...
    Procesados 13800/15262 segmentos...
    Procesados 13900/15262 segmentos...
    Procesados 14000/15262 segmentos...
    Procesados 14100/15262 segmentos...
    Procesados 14200/15262 segmentos...
    Procesados 14300/15262 segmentos...
    Procesados 14400/15262 segmentos...
    Procesados 14500/15262 segmentos...
    Procesados 14600/15262 segmentos...
    Procesados 14700/15262 segmentos...
    Procesados 14800/15262 segmentos...
    Procesados 14900/15262 segmentos...
    Procesados 15000/15262 segmentos...
    Procesados 15100/15262 segmentos...
    Procesados 15200/15262 segmentos...
Extrayendo MFCC de test...
    Procesados 100/3686 segmentos...
    Procesados 200/3686 segmentos...
    Procesados 300/3686 segmentos...
    Procesados 400/3686 segmentos...
    Procesados 500/3686 segmentos...
    Procesados 600/3686 segmentos...
    Procesados 700/3686 segmentos...
    Procesados 800/3686 segmentos...
    Procesados 900/3686 segmentos...
    Procesados 1000/3686 segmentos...
    Procesados 1100/3686 segmentos...
    Procesados 1200/3686 segmentos...
    Procesados 1300/3686 segmentos...
    Procesados 1400/3686 segmentos...
    Procesados 1500/3686 segmentos...
    Procesados 1600/3686 segmentos...
    Procesados 1700/3686 segmentos...
    Procesados 1800/3686 segmentos...
    Procesados 1900/3686 segmentos...
    Procesados 2000/3686 segmentos...
    Procesados 2100/3686 segmentos...
    Procesados 2200/3686 segmentos...
    Procesados 2300/3686 segmentos...
    Procesados 2400/3686 segmentos...
    Procesados 2500/3686 segmentos...
    Procesados 2600/3686 segmentos...
    Procesados 2700/3686 segmentos...
    Procesados 2800/3686 segmentos...
    Procesados 2900/3686 segmentos...
    Procesados 3000/3686 segmentos...
    Procesados 3100/3686 segmentos...
    Procesados 3200/3686 segmentos...
    Procesados 3300/3686 segmentos...
    Procesados 3400/3686 segmentos...
    Procesados 3500/3686 segmentos...
    Procesados 3600/3686 segmentos...
Extrayendo MFCC de blind...
    Procesados 100/2365 segmentos...
    Procesados 200/2365 segmentos...
    Procesados 300/2365 segmentos...
    Procesados 400/2365 segmentos...
    Procesados 500/2365 segmentos...
    Procesados 600/2365 segmentos...
    Procesados 700/2365 segmentos...
    Procesados 800/2365 segmentos...
    Procesados 900/2365 segmentos...
    Procesados 1000/2365 segmentos...
    Procesados 1100/2365 segmentos...
    Procesados 1200/2365 segmentos...
    Procesados 1300/2365 segmentos...
    Procesados 1400/2365 segmentos...
    Procesados 1500/2365 segmentos...
    Procesados 1600/2365 segmentos...
    Procesados 1700/2365 segmentos...
    Procesados 1800/2365 segmentos...
    Procesados 1900/2365 segmentos...
    Procesados 2000/2365 segmentos...
    Procesados 2100/2365 segmentos...
    Procesados 2200/2365 segmentos...
    Procesados 2300/2365 segmentos...

  [CACHE] Features guardadas en 02seg/mfcc_cache/features_xvector_overlap_0.5.pt

Total samples: 18948
Clases: Plate=3, Electrode=4, Current=2

============================================================
K-FOLD CROSS-VALIDATION
============================================================

Fold 1/10
Traceback (most recent call last):
  File "/home/luis/projects/tesis/audio/spectral-analysis/entrenar_xvector.py", line 509, in <module>
    main()
  File "/home/luis/projects/tesis/audio/spectral-analysis/entrenar_xvector.py", line 447, in main
    model, swa_model, metrics = train_model(model, train_loader, val_loader, device)
  File "/home/luis/projects/tesis/audio/spectral-analysis/entrenar_xvector.py", line 240, in train_model
    out = model(x)
  File "/home/luis/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/luis/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/luis/projects/tesis/audio/spectral-analysis/weld_audio_classifier/models/xvector.py", line 99, in forward
    x = self.frame1(x)
  File "/home/luis/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/luis/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/luis/projects/tesis/audio/spectral-analysis/weld_audio_classifier/models/xvector.py", line 27, in forward
    x = self.conv(x)
  File "/home/luis/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/luis/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/luis/.local/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 371, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/luis/.local/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 366, in _conv_forward
    return F.conv1d(
RuntimeError: Calculated padded input size per channel: (1). Kernel size: (5). Kernel size can't be greater than actual input size
